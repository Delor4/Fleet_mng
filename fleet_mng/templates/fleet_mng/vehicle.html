{# Wyświetlenie danych konkretnego pojazdu #}
{% extends "fleet_mng/_base.html" %}
{% block content %}
{% load static %}
<a href="{% url 'fleet_mng:vehicles' %}">
    <button class="btn btn-primary btn-sm" type="button"><</button>
</a><br>
<div class="container">
  <div class="table-responsive">
    <table class="table table-bordered" id="vehicle-table">
      <tbody>
        <tr>
          <td>Nazwa:</td>
          <td>{{ vehicle.name }}</td>
        </tr>

        <tr>
          <td>Marka:</td>
          <td>{{ vehicle.brand }}</td>
        </tr>

        <tr>
          <td>Model</td>
          <td>{{ vehicle.model }}</td>
        </tr>

        <tr>
          <td>Typ:</td>
          <td>{{ vehicle.generation }}</td>
        </tr>

        <tr>
          <td>Numer rejestracyjny:</td>
          <td>{{ vehicle.registration_number }}</td>
        </tr>

        <tr>
          <td>Przebieg:</td>
          <td>{{ vehicle.mileage }}</td>
        </tr>

        <tr>
          <td>Termin przeglądu:</td>
          <td>{{ vehicle.checkup|default:'------' }}</td>
        </tr>

        <tr>
          <td>Termin ubezpieczenia:</td>
          <td>{{ vehicle.insurance|default:'------' }}</td>
        </tr>

        <tr>
          <td>Uwagi:</td>
          <td>{{ vehicle.description }}</td>
        </tr>

        {%if vehicle.is_rented %}
        {% for rent in vehicle.get_current_renters %}
        <tr>
          <td>
            {% if perms.fleet_mng.view_rent %}
            <a href="{% url 'fleet_mng:rent' rent.id %}">Wypożyczony</a> przez:
            {% else %}
            Wypożyczony przez:
            {% endif %}
          </td>
          <td>
            {% if perms.fleet_mng.view_renter %}
            <a href="{% url 'fleet_mng:renter' rent.renter.id %}">{{ rent.renter }}</a>
            {% else %}
            {{ rent.renter }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td>Termin oddania:</td>
          <td>
            {%if rent.rented %}
            {{rent.to_date}}
            {% endif %}
          </td>
        </tr>
        {% endfor %}
        {% endif %}
      </tbody>
    </table>
  </div>

    {% if perms.fleet_mng.change_vehicle %}
    <div class="row">
        <a href="{% url 'fleet_mng:vehicle_edit' vehicle.id%}" class="btn">
            <button class="btn btn-primary btn-xs" type="button">Edytuj</button>
        </a>
    </div>
    {% endif %}
   {% if perms.fleet_mng.delete_vehicle %}
    <script src="{% static 'fleet_mng/form_helpers.js' %}"></script>
    <form method=post name="delete_form" action="{% url 'fleet_mng:vehicle_delete' vehicle.id %}"
          onsubmit="_delete(event,this,{% if vehicle.deleted == 1 %}'Potwierdź przywrócenie pojazdu.'{% else %}'Potwierdź usunięcie pojazdu.'{% endif %});"/>
    {% csrf_token %}
    <input type=hidden name="delete" value="{% if vehicle.deleted == 1 %}0{% else %}1{% endif %}"/>
    <input type=hidden name="confirm" value="0"/>
    <input type=submit value="{% if vehicle.deleted == 1 %}Przywróć{% else %}Usuń{% endif %}"/>
    </form>
    {% endif %}
</div>
{% endblock %}
